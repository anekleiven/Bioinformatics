"0","rows.mut <- which(sample.tbl$genotype == ""Mutant"" & sample.tbl$treatment == ""Control"")"
"0","rows.wt <- which(sample.tbl$genotype == ""WT"" & sample.tbl$treatment == ""Control"")"
"0",""
"0","kontroll.tbl <- gene.tbl |> "
"0","  filter(gene_id %in% colnames(tpm.mat)) |> "
"0","  mutate(p_value = -1) |> "
"0","  mutate(log2FC = 0)"
"0",""
"0","for(i in 1:nrow(kontroll.tbl)) {"
"0","  x <- tpm.mat[rows.mut, i]"
"0","  y <- tpm.mat[rows.wt, i]"
"0","  tst.obj <- wilcox.test(x, y)"
"0","  kontroll.tbl$log2FC[i] <- log2(mean(x)/mean(y))"
"0","  kontroll.tbl$p_value[i] = tst.obj$p.value"
"0","}"
"0",""
"0","kontroll.tbl <- kontroll.tbl |> "
"0","  mutate(q_value = p.adjust(p_value, method = ""fdr"")) |> "
"0","  mutate(signifikant = q_value < 0.05) |> "
"0","  mutate(regulert = case_when("
"0","    log2FC < -1 ~ 'Nedregulert',"
"0","    log2FC > 1 ~ 'Oppregulert',"
"0","    .default = ""Uregulert"""
"0","  ))"
