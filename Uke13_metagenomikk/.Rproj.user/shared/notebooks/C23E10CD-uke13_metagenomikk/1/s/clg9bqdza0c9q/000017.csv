"0","salmon.filtered <- salmon[match(rownames(abundance.mat), salmon$run_accession), ]"
"0",""
"0","rows.farm <- which(salmon.filtered$environment == 'Farm')"
"0","rows.wild <- which(salmon.filtered$environment == ""Wild"")"
"0",""
"0","# Resultatlister"
"0","p_values <- numeric(ncol(abundance.mat))"
"0","log2FCs <- numeric(ncol(abundance.mat))"
"0",""
"0","# Wilcoxon-test per OTU"
"0","for (i in seq_len(ncol(abundance.mat))) {"
"0","  x <- abundance.mat[rows.farm, i]"
"0","  y <- abundance.mat[rows.wild, i]"
"0","  "
"0","  tst <- wilcox.test(x, y)"
"0","  log2FCs[i] <- log2(mean(x) / mean(y)) "
"0","  p_values[i] <- tst$p.value"
"0","}"
"0",""
"0","# Korriger for FDR"
"0","q_values <- p.adjust(p_values, method = ""fdr"")"
"0",""
"0","# Resultattabell"
"0","OTU_results <- tibble("
"0","  OTU = colnames(abundance.mat),"
"0","  log2FC = log2FCs,"
"0","  p_value = p_values,"
"0","  q_value = q_values,"
"0","  signifikant = q_value < 0.05,"
"0","  regulert = case_when("
"0","    log2FC < -1 ~ ""Nedregulert"","
"0","    log2FC > 1 ~ ""Oppregulert"","
"0","    TRUE ~ ""Uregulert"""
"0","  )"
"0",")"
"0",""
"0","# Antall signifikante OTUer"
"0","antall_signifikante <- sum(OTU_results$signifikant)"
"0","cat(""Antall signifikante OTUer:"", antall_signifikante, ""\n"")"
"1","Antall signifikante OTUer:"
"1"," "
"1","1750"
"1"," "
"1","
"
